# 通知模板配置指南

Komari 支持自定义通知模板，允许您根据需要定制通知消息的格式和内容。通过使用模板变量，您可以创建个性化、信息丰富的通知消息。

## 模板变量说明

Komari 提供以下模板变量，可在通知模板中使用。

你可以替换模板中的变量来定制通知内容。变量使用双重大括号包裹。

### 基础变量

| 变量      | 类型   | 描述                         | 示例值                            |
| --------- | ------ | ---------------------------- | --------------------------------- |
| `event`   | 字符串 | 事件类型，表示发生的具体事件 | `offline`、`online`、`alert`      |
| `client`  | 字符串 | 触发事件的服务器名称         | `Web服务器01`、`数据库服务器`     |
| `time`    | 字符串 | 触发事件的时间戳             | `2024-01-15 14:30:25`             |
| `message` | 字符串 | 详细信息或错误描述           | `服务器响应超时`、`CPU使用率过高` |
| `emoji`   | 字符串 | 对应事件类型的 Emoji 图标    | `🔴`、`🟢`、`⚠️`                  |

## 配置方法

### 1. 进入通知设置

1. 登录 Komari 管理后台
2. 进入 **设置** → **通知**
3. 启用通知功能并选择通知渠道

### 2. 保存并测试

- 编辑完成后点击保存
- 使用"发送测试消息"功能验证模板效果

## 示例

```text
{{emoji}}{{emoji}}{{emoji}}
事件：{{event}}
服务器：{{client}}
消息：{{message}}
时间：{{time}}
```

## Javascript 通知配置

必须实现 `sendMessage(title: string, message: string): bool` 函数。

可选实现 `sendEvent(event): bool` 函数以启用事件通知。

事件对象包含以下字段：

| 字段      | 类型        | 描述                                       | 示例值                 |
| --------- | ----------- | ------------------------------------------ | ---------------------- |
| `event`   | 字符串      | 事件类型，用以标识通知类别                 | `offline`              |
| `clients` | Client 数组 | 关联的客户端列表，结构体 `Client` 按需扩展 |                        |
| `time`    | 时间        | 事件发生时间                               | `2024-01-15T14:30:25Z` |
| `message` | 字符串      | 事件的详细说明或提示信息                   | ` `                    |
| `emoji`   | 字符串      | 与事件匹配的 Emoji 图标                    | `🔴`                   |

Client 结构体见：https://github.com/komari-monitor/komari/blob/b62fb1f70889fc1ac94e7c58ed928d7a27df5d09/database/models/models.go#L10
